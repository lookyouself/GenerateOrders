<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="robots" content="noindex, nofollow, noarchive">
    <meta property="og:title" content="Your Apple eGift Card">
    <meta property="og:description" content="Your Use the Apple Gift Card to get products, accessories, apps, games, music, movies, TV shows, and more. Spend it on in-app content, books, subscriptions and even iCloud storage to secure files from all your Apple devices. This gift card does it all. And then some. eGift Card">
    <meta property="og:image" content="https://content.blackhawknetwork.com/gcmimages/manufacturer/masterimage/6HXP3PGFQDSDPWJVVS0L1T9G8M-en_US.jpeg?dt=1596486061263">
    <meta property="og:website" content="egift.activationspot.com">

    <script async src="https://www.googletagmanager.com/gtm.js?id=GTM-K2773WN9&amp;l=adobeDataLayer"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta charset="utf-8">
    <title>Your Apple eGift Card</title>
    <meta name="description" content="Giftcardmall.com eGift">
    <meta name="author" content="Blackhawk Network">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no">
    <link rel="shortcut icon" type="image/x-icon" href="https://content.blackhawknetwork.com/gcmimages/View/37DQFW6Z5RZR2BADH857MX9PVC/images/favicon.ico">

    <!-- 原有样式 -->
    <link rel="stylesheet" type="text/css" href="https://content.blackhawknetwork.com/gcmimages/View/37DQFW6Z5RZR2BADH857MX9PVC/css/style.css?v=20240417">
    <link rel="stylesheet" type="text/css" href="https://content.blackhawknetwork.com/gcmimages/View/37DQFW6Z5RZR2BADH857MX9PVC/css/layout.css?v=20230608">
    <link rel="stylesheet" type="text/css" href="https://content.blackhawknetwork.com/gcmimages/View/37DQFW6Z5RZR2BADH857MX9PVC/css/print.css?v=20230608" media="print">
    <link type="text/css" rel="stylesheet" href="css/wallet.css?v=20150310">
    <link type="text/css" rel="stylesheet" href="css/aselements.css">
    
    <!-- 状态栏依赖（CDN优化） -->
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/flatpickr/4.6.13/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/flatpickr/4.6.13/themes/airbnb.min.css">

    <!-- jQuery -->
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <!-- Google Tag Manager -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'adobeDataLayer', 'GTM-K2773WN9');
    </script>

    <!-- 优化后的样式 -->
    <style>
        /* 控制面板优化：更紧凑的布局 */
        #controlPanel {
            position: fixed;
            top: 10px;
            left: 10px;
            background: #fff;
            border: 1px solid #e5e7eb;
            padding: 12px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, .08);
            z-index: 9999;
            font-size: 14px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 280px;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
            border-bottom: 1px solid #f3f4f6;
            padding-bottom: 8px;
        }
        
        .control-group:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .control-group label {
            font-weight: 600;
            font-size: 12px;
            color: #111827;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .control-group input,
        .control-group select {
            padding: 8px 10px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 14px;
            box-sizing: border-box;
            font-family: inherit;
            transition: border-color 0.2s ease;
        }
        
        .control-group input:focus,
        .control-group select:focus {
            outline: none;
            border-color: #0071e3;
            box-shadow: 0 0 0 2px rgba(0, 113, 227, 0.2);
        }

        #pinTip {
            color: #ff3b30;
            font-size: 11px;
            margin-top: 2px;
            display: none;
            line-height: 1.4;
        }

        .tips-text {
            color: #ff3b30;
            font-size: 14px;
            line-height: 1.5;
            font-weight: 600;
            margin: 0 0 8px 0;
            text-align: center;
        }

        /* 响应式优化 */
        @media (max-width: 768px) {
            #controlPanel {
                top: 5px;
                left: 5px;
                width: 240px;
                padding: 10px;
                gap: 8px;
            }

            .boilerplate {
                max-width: 100%;
                padding-left: 250px !important;
            }
        }

        /* 主内容区域适配 */
        .boilerplate {
            max-width: 1200px;
            margin: 0 auto !important;
            padding-left: 300px !important;
            box-sizing: border-box;
            padding-top: 20px;
        }

        #main {
            width: 100%;
        }

        /* ========== iOS 17+ 状态栏极致还原 ========== */
        .phone-status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 16px !important; /* 精准匹配iOS内边距 */
            background-color: #ffffff;
            font-size: 15px; /* iOS 17 状态栏字号 */
            letter-spacing: 0.3px; /* 精准匹配iOS字间距 */
            color: #000000;
            /* 纯iOS系统字体栈 */
            font-family: -apple-system, "SF Pro Text", "Helvetica Neue", sans-serif;
            font-weight: 400; /* iOS原生权重，非加粗更真实 */
            border-radius: 0;
            margin-bottom: 16px;
            border: none;
            /* 平滑过渡动画 */
            transition: all 0.2s ease-in-out;
        }
        
        /* iOS原生时间样式 */
        #status-time-display {
            font-weight: 500;
            color: #1d1d1f;
        }
        
        /* iOS原生图标/文字样式 */
        .status-right span, .status-right i {
            margin-left: 4px;
            vertical-align: middle;
            font-weight: 400;
            color: #1d1d1f;
            font-size: 14.5px;
        }
        
        /* 低电量样式精准还原 */
        .status-bar-low-battery .fa-battery-quarter {
            color: #ff3b30;
            font-weight: 500;
        }
        
        /* 充电样式优化 */
        .status-bar-charging .fa-battery-three-quarters::after {
            content: "\f0e7";
            font-family: FontAwesome;
            font-size: 10px;
            position: relative;
            left: -9px;
            top: -2px;
            color: #1d1d1f;
        }

        /* ========== 时间选择器优化 ========== */
        .flatpickr-calendar {
            width: 280px !important;
            min-height: unset !important;
            height: auto !important;
            border-radius: 12px !important;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb !important;
            padding: 12px !important;
            font-family: inherit;
        }
        
        .flatpickr-time {
            width: 100% !important;
            padding: 10px 5px !important;
            height: auto !important;
            display: flex !important;
            align-items: center !important;
            justify-content: space-around !important;
        }
        
        .numInputWrapper {
            width: 60px !important;
            height: 38px !important;
            border: 1px solid #e5e7eb !important;
            border-radius: 8px !important;
            margin: 0 5px !important;
        }
        
        .numInput {
            width: 100% !important;
            height: 100% !important;
            font-size: 16px !important;
            line-height: 38px !important;
            text-align: center !important;
            border: none !important;
            outline: none !important;
            font-family: inherit;
        }
        
        .flatpickr-am-pm {
            font-size: 14px !important;
            color: #0071e3 !important;
            padding: 5px 8px !important;
            height: 38px !important;
            line-height: 38px !important;
            font-weight: 600;
        }
        
        .flatpickr-days {
            display: none !important;
        }

        /* 隐藏无关元素 */
        #trackImg, .gowallet-callout-container,
        #bhn_ubutton, #ie_bhn_ubutton, .mSaveBtn {
            display: none !important;
        }
    </style>

    <!-- 控制面板 -->
    <div id="controlPanel">
        <p class="tips-text">先查卡片的国家、金额，再去 p 图</p>
        
        <!-- 状态栏控制 -->
        <div class="control-group">
            <label>iPhone状态栏样式</label>
            <select id="status-style">
                <option value="default">1. 基础款（LTE+满电）</option>
                <option value="5g">2. 5G网络款（5G+80%电量）</option>
                <option value="do-not-disturb">3. 勿扰模式款（专注模式+Wi-Fi）</option>
                <option value="low-battery">4. 低电量款（LTE+20%红色电量）</option>
                <option value="charging">5. 充电款（LTE+充电图标）</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>状态栏时间（美国风格）</label>
            <input type="text" id="status-time" placeholder="选择时间（如 10:13 AM）" readonly>
        </div>
        
        <!-- 金额/PIN码控制 -->
        <div class="control-group">
            <label>货币类型</label>
            <select id="cur">
                <option value="$">$ 美元</option>
                <option value="€">€ 欧元</option>
                <option value="£">£ 英镑</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>卡片金额</label>
            <input type="number" id="amt" min="1" step="1" placeholder="请输入金额">
        </div>
        
        <div class="control-group">
            <label>PIN码（16位）</label>
            <input type="text" id="pin" maxlength="16" placeholder="请输入16位字母/数字">
            <div id="pinTip">PIN必须为16位字母/数字！</div>
        </div>
    </div>

    <!-- 优化后的核心脚本 -->
    <script>
        // 全局配置常量（集中管理）
        const APP_CONFIG = {
            DEFAULT_AMOUNT: 100,
            DEFAULT_CURRENCY: '$',
            DEFAULT_PIN: 'XQ7CN7K28CGX894P',
            EID: 'HC64GXQBZT1YZ3J48MNFMCF6X8',
            TID: 'YK1PHH1DX97D1S1Z9HQR847P7C',
            COUNTRY_CODE: 'USD',
            PRODUCT_NAME: 'Apple Gift Card',
            PHONE_NUMBER: '07675043504',
            // 状态栏配置
            STATUS_BAR_STYLES: {
                default: {
                    html: '<i class="fa fa-signal" aria-hidden="true"></i><span>LTE</span><i class="fa fa-battery-full" aria-hidden="true"></i>',
                    class: ''
                },
                '5g': {
                    html: '<i class="fa fa-signal" aria-hidden="true"></i><span>5G</span><i class="fa fa-battery-three-quarters" aria-hidden="true"></i><span>80%</span>',
                    class: ''
                },
                'do-not-disturb': {
                    html: '<i class="fa fa-moon-o" aria-hidden="true"></i><i class="fa fa-wifi" aria-hidden="true"></i><i class="fa fa-battery-full" aria-hidden="true"></i>',
                    class: ''
                },
                'low-battery': {
                    html: '<i class="fa fa-signal" aria-hidden="true"></i><span>LTE</span><i class="fa fa-battery-quarter" aria-hidden="true"></i><span>20%</span>',
                    class: 'status-bar-low-battery'
                },
                'charging': {
                    html: '<i class="fa fa-signal" aria-hidden="true"></i><span>LTE</span><i class="fa fa-battery-three-quarters" aria-hidden="true"></i><span>90%</span>',
                    class: 'status-bar-charging'
                }
            }
        };

        // 工具函数封装（复用性提升）
        const utils = {
            // 安全的DOM查询
            $: (selector) => {
                const el = document.querySelector(selector);
                if (!el) console.warn(`元素未找到: ${selector}`);
                return el;
            },
            // 生成唯一ID
            generateCorrelationId: () => crypto.randomUUID(),
            // 格式化金额
            formatAmount: (currency, amount) => `${currency}${amount}`,
            // 防抖函数
            debounce: (func, delay = 300) => {
                let timeoutId;
                return (...args) => {
                    clearTimeout(timeoutId);
                    timeoutId = setTimeout(() => func.apply(this, args), delay);
                };
            },
            // 获取当前美国时间（格式化）
            getCurrentUSATime: () => {
                const options = { 
                    hour: 'numeric', 
                    minute: 'numeric', 
                    hour12: true,
                    timeZone: 'America/New_York'
                };
                return new Date().toLocaleTimeString('en-US', options).replace(/:/g, ':').replace(/\s+/g, ' ');
            },
            // 验证PIN码
            validatePin: (pin) => {
                return /^[A-Z0-9]{16}$/.test(pin);
            }
        };

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function () {
            // 初始化全局变量
            window.coRelationId = utils.generateCorrelationId();
            window.asJq = jQuery.noConflict();

            // ========== 1. 状态栏初始化（优化版） ==========
            initStatusBar();
            
            // ========== 2. 金额/PIN码初始化（优化版） ==========
            initAmountPinControls();
        });

        /**
         * 初始化状态栏功能（独立封装）
         */
        function initStatusBar() {
            // 获取DOM元素（只查询一次）
            const statusStyleSelect = utils.$('#status-style');
            const statusIcons = utils.$('#status-icons');
            const statusBar = utils.$('#custom-status-bar');
            const statusTimeInput = utils.$('#status-time');
            const statusTimeDisplay = utils.$('#status-time-display');

            // 提前校验元素是否存在
            if (!statusStyleSelect || !statusIcons || !statusBar || !statusTimeInput || !statusTimeDisplay) {
                console.error('状态栏核心元素缺失，初始化失败');
                return;
            }

            // 初始化时间选择器（默认显示当前美国时间）
            const defaultTime = utils.getCurrentUSATime();
            const timePicker = flatpickr('#status-time', {
                enableTime: true,
                noCalendar: true,
                time_24hr: false,
                minuteIncrement: 1,
                defaultDate: defaultTime,
                dateFormat: "h:i K",
                position: "bottom",
                locale: "en",
                onChange: function(selectedDates, dateStr) {
                    statusTimeInput.value = dateStr;
                    statusTimeDisplay.textContent = dateStr;
                }
            });

            // 设置默认时间
            statusTimeInput.value = defaultTime;
            statusTimeDisplay.textContent = defaultTime;

            // 状态栏样式切换（优化逻辑）
            statusStyleSelect.addEventListener('change', utils.debounce(function() {
                const styleKey = this.value;
                const styleConfig = APP_CONFIG.STATUS_BAR_STYLES[styleKey] || APP_CONFIG.STATUS_BAR_STYLES.default;
                
                // 重置样式并应用新样式
                statusBar.className = 'phone-status-bar';
                if (styleConfig.class) {
                    statusBar.classList.add(styleConfig.class);
                }
                
                // 更新图标
                statusIcons.innerHTML = styleConfig.html;
            }, 100));

            // 初始化默认样式
            statusIcons.innerHTML = APP_CONFIG.STATUS_BAR_STYLES.default.html;
        }

        /**
         * 初始化金额/PIN码控制（独立封装）
         */
        function initAmountPinControls() {
            // 获取DOM元素（只查询一次）
            const elements = {
                amountSpan: utils.$('#sbux-amount span'),
                pinLink: utils.$('.pin span a'),
                pinInput: utils.$('#pin'),
                pinTip: utils.$('#pinTip'),
                amtInput: utils.$('#amt'),
                curSelect: utils.$('#cur')
            };

            // 初始化输入框值（容错处理）
            function initInputValues() {
                // 货币初始化
                const cur = elements.amountSpan ? elements.amountSpan.textContent[0] : APP_CONFIG.DEFAULT_CURRENCY;
                if (elements.curSelect) {
                    elements.curSelect.value = ['$', '€', '£'].includes(cur) ? cur : APP_CONFIG.DEFAULT_CURRENCY;
                }

                // 金额初始化
                const num = elements.amountSpan ? (elements.amountSpan.textContent.match(/\d+/) || [APP_CONFIG.DEFAULT_AMOUNT])[0] : APP_CONFIG.DEFAULT_AMOUNT;
                if (elements.amtInput) {
                    elements.amtInput.value = num;
                }

                // PIN码初始化
                const pin = elements.pinLink ? elements.pinLink.textContent : APP_CONFIG.DEFAULT_PIN;
                if (elements.pinInput) {
                    elements.pinInput.value = pin;
                }
                if (elements.pinTip) {
                    elements.pinTip.style.display = 'none';
                }
            }

            // PIN码校验（防抖处理）
            function initPinValidation() {
                if (!elements.pinInput || !elements.pinTip || !elements.pinLink) return;

                // 实时校验（防抖）
                elements.pinInput.addEventListener('input', utils.debounce(function (e) {
                    // 格式化输入：大写 + 仅字母数字
                    this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
                    
                    // 长度限制
                    if (this.value.length > 16) {
                        this.value = this.value.slice(0, 16);
                    }
                    
                    // 校验反馈
                    const isValid = utils.validatePin(this.value);
                    elements.pinTip.style.display = (this.value.length > 0 && !isValid) ? 'block' : 'none';
                    
                    // 同步到页面（仅当有效时）
                    if (this.value) {
                        elements.pinLink.textContent = this.value;
                        elements.pinLink.href = elements.pinLink.href.replace(/[A-Z0-9]{16}/, this.value);
                    }
                }, 200));

                // 失去焦点校验
                elements.pinInput.addEventListener('blur', function () {
                    const isValid = utils.validatePin(this.value);
                    elements.pinTip.style.display = (this.value.length > 0 && !isValid) ? 'block' : 'none';
                });
            }

            // 金额校验（防抖处理）
            function initAmountValidation() {
                if (!elements.amtInput || !elements.amountSpan || !elements.curSelect) return;

                // 实时校验
                elements.amtInput.addEventListener('input', utils.debounce(function () {
                    // 最小值限制
                    if (this.value < 1) {
                        this.value = 1;
                    }
                    
                    // 同步到页面
                    if (this.value) {
                        elements.amountSpan.textContent = utils.formatAmount(elements.curSelect.value, this.value);
                    }
                }, 200));

                // 失去焦点校验
                elements.amtInput.addEventListener('blur', function () {
                    if (!this.value) {
                        this.value = APP_CONFIG.DEFAULT_AMOUNT;
                    } else if (this.value < 1) {
                        this.value = 1;
                    }
                    elements.amountSpan.textContent = utils.formatAmount(elements.curSelect.value, this.value);
                });
            }

            // 货币切换同步
            function initAmountSync() {
                if (!elements.curSelect || !elements.amountSpan || !elements.amtInput) return;

                elements.curSelect.addEventListener('change', function (e) {
                    if (elements.amtInput.value) {
                        elements.amountSpan.textContent = utils.formatAmount(e.target.value, elements.amtInput.value);
                    }
                });
            }

            // 执行初始化
            initInputValues();
            initPinValidation();
            initAmountValidation();
            initAmountSync();
        }

        // ========== 原有业务逻辑（保留） ==========
        async function postWallets(data) {
            data.deviceType = navigator.userAgent;
            const url = `/eventLogs?eid=${APP_CONFIG.EID}&tid=${APP_CONFIG.TID}`;
            try {
                const response = await fetch(url, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data),
                });
            } catch (error) {
                console.error("Wallet API Error:", error);
            }
        }

        function walletClickEvent(wallet) {
            const walletNames = {
                "GOOGLE": 'Add to Google Wallet',
                "SAMSUNG": 'Save to SAMSUNG pay',
                "APPLE": 'Add to Apple Wallet',
                "DEFAULT": 'Add to Wallet'
            };
            const data = {
                "type": "WALLET",
                "subTypes": [wallet],
                "action": "CLICKED",
                "coRelationId": window.coRelationId,
            };
            postWallets(data);
            pushLinkClickEventWithoutEmail(`button|main|${walletNames[wallet] || walletNames.DEFAULT}`, walletNames[wallet] || walletNames.DEFAULT, '');
        }

        function walletsVisibleLog(samsungWalletJwt) {
            document.getElementById("S2P-root")?.addEventListener('click', function () {
                walletClickEvent("SAMSUNG");
            });

            const userAgent = navigator.userAgent.toLowerCase();
            const isAppleWalletVisible = !!document.getElementById("passLink");
            const isSamsungWalletVisible = userAgent.indexOf('iphone') === -1 && !!samsungWalletJwt;
            const isGoogleWalletVisible = false && !isAppleWalletVisible;
            const walletsVisible = [];

            if (isAppleWalletVisible) walletsVisible.push("APPLE");
            if (isSamsungWalletVisible) walletsVisible.push("SAMSUNG");
            if (isGoogleWalletVisible) walletsVisible.push("GOOGLE");

            if (walletsVisible.length > 0) {
                postWallets({
                    "type": "WALLET",
                    "subTypes": walletsVisible,
                    "action": "VIEWED",
                    "coRelationId": window.coRelationId,
                });
            }
        }

        function shareUsingWebShareAPI() {
            const shareData = {
                title: 'Your eGift',
                text: 'Sending some digital cheer your way!',
                url: `https://egift.activationspot.com/eGiftApplication/v1/egift?tid=${APP_CONFIG.TID}&gw=n&gs=n&gcm=n&eid=${APP_CONFIG.EID}`
            };

            if (navigator.share) {
                navigator.share(shareData)
                    .then(() => console.log('Content shared successfully!'))
                    .catch((error) => console.error('Error sharing content:', error));
            } else {
                console.log('Web Share API is not supported in this browser.');
            }
        }

        async function generateToken(endPoint, payloadData) {
            try {
                payloadData.deviceType = navigator.userAgent;
                const newWindow = window.open("", "_blank");
                if (!newWindow) {
                    alert('弹窗被浏览器拦截，请允许弹窗后重试');
                    return;
                }

                const token = await fetch(endPoint, {
                    method: "POST",
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payloadData)
                })
                    .then(res => res.text())
                    .then(res => {
                        const branchIoBaseUrl = '';
                        let branchIoUrl = branchIoBaseUrl.concat(res.replace(/['"]+/g, ''));
                        newWindow.location.href = branchIoUrl;
                        return branchIoUrl;
                    });
            } catch (error) {
                console.error("Token generation error:", error);
            }
        }

        if (document.getElementById("passLink")) {
            document.getElementById("passLink").onclick = function () {
                walletClickEvent("APPLE");
                window.open(`/getApplePass?eid=${APP_CONFIG.EID}&tid=${APP_CONFIG.TID}`);
            };
        }

        function loadGiftCardAppUrl() {
            window.open(`?requestor=BHN&account=&verification=`);
        }

        function loadGoogleWallet() {
            walletClickEvent("GOOGLE");
            window.open(`/google-wallets?eid=${APP_CONFIG.EID}&tid=${APP_CONFIG.TID}`);
        }

        async function loadBranchIoUrl() {
            const payloadData = { "lastFourPhoneNumber": '', "proxyCardNumber": '' };
            const endPoint = "/getOpenLoopToken";
            generateToken(endPoint, payloadData);
        }

        window.addEventListener('load', function () {
            walletsVisibleLog("");

            (function (i, s, o, g, r, a, m) {
                i["GoogleAnalyticsObject"] = r;
                i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
                a = s.createElement(o), m = s.getElementsByTagName(o)[0];
                a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, "script", "//www.google-analytics.com/analytics.js", "ga");

            ga("create", "UA-9396103-7", "activationspot.com");
            ga("send", "pageview");
            ga("send", "event", "Apple", "Apple");
        });

        asJq(document).ready(function () {
            asJq("#btnOpenLoopWallet").on('click', function (event) {
                event.preventDefault();
                var el = asJq(this);
                if (el.prop('disabled')) return;
                el.prop('disabled', true);
                setTimeout(() => el.prop('disabled', false), 4000);
            });

            let showCatalogdropdown = true;
            const $langDropdown = asJq("#catalogLangDropDown");
            if ($langDropdown.find('option').length <= 1 || asJq(".mainDivLn").length !== 0) {
                $langDropdown.hide();
                showCatalogdropdown = false;
            }

            if ($langDropdown.find('option').length >= 1 && showCatalogdropdown) {
                let url = new URL(window.location.href);
                let language = url.searchParams.get("lang");
                if (language) $langDropdown.val(language);

                $langDropdown.show().on('change', function () {
                    let url = new URL(window.location.href);
                    url.searchParams.set("lang", asJq(this).val());
                    window.location.href = url;
                });
            }

            const buttonRow = document.querySelector('.button-row');
            const shareButton = document.querySelector('.walletShareH');
            const bannerTop = document.querySelector('.bannerTopH');
            const twoBtnBanner = document.querySelector('.twoBtnBannerH');
            const walletShare = document.querySelector('.walletShareH');

            if (!shareButton && buttonRow) {
                buttonRow.classList.add('buttonRowShowSingleBtn');
            }

            if (navigator.share) {
                if (bannerTop) bannerTop.classList.add('bannerTop');
                if (twoBtnBanner) twoBtnBanner.classList.add('twoBtnBanner');
                if (walletShare) walletShare.classList.add('walletShare');
            } else {
                if (bannerTop) bannerTop.classList.add('noBannerTop');
                if (twoBtnBanner) twoBtnBanner.classList.add('noTwoBtnBanner');
                if (walletShare) walletShare.classList.add('noWalletShare');
                if (buttonRow) buttonRow.classList.add('buttonRowShowSingleBtn');
            }
        });

        function pushPageLoadEvent(eventType, pageName, url, hash, currency, amount, product, tid, phone, email, experiment, variant, userId, eventSubType) {
            console.log(`Page event: ${eventType}`, { pageName, amount, currency });
        }

        function pushExperimentEvent(eventType, pageName, url, hash, currency, amount, product, tid, phone, email, experiment, variant, userId, eventSubType) {
            console.log(`Experiment event: ${eventType}`, { pageName, amount, currency });
        }

        pushPageLoadEvent(
            'page|load',
            'egift-next',
            'https://egift.activationspot.com',
            'EAAQcjvAC3WOtC9HFww5+tEqQTFyFTM=',
            APP_CONFIG.COUNTRY_CODE,
            APP_CONFIG.DEFAULT_AMOUNT,
            APP_CONFIG.PRODUCT_NAME,
            APP_CONFIG.TID,
            APP_CONFIG.PHONE_NUMBER,
            '',
            null,
            'null',
            'null',
            'PAGE_LOAD'
        );

        window.onbeforeunload = function () {
            pushExperimentEvent(
                'page|load',
                'egift-next',
                'https://egift.activationspot.com',
                'EAAQcjvAC3WOtC9HFww5+tEqQTFyFTM=',
                APP_CONFIG.COUNTRY_CODE,
                APP_CONFIG.DEFAULT_AMOUNT,
                APP_CONFIG.PRODUCT_NAME,
                APP_CONFIG.TID,
                APP_CONFIG.PHONE_NUMBER,
                '',
                null,
                'null',
                'null',
                'UNLOADED'
            );
        };

        if ("5228614" && "6") {
            (function (h, o, t, j, a, r) {
                h.hj = h.hj || function () {
                    (h.hj.q = h.hj.q || []).push(arguments)
                };
                h._hjSettings = { hjid: "5228614", hjsv: "6" };
                a = o.getElementsByTagName('head')[0];
                r = o.createElement('script');
                r.async = 1;
                r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
                a.appendChild(r);
            })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
        }

        window.NREUM || (NREUM = {});
        NREUM.info = {
            "errorBeacon": "bam.nr-data.net",
            "licenseKey": "673ac2fa6e",
            "agent": "",
            "beacon": "bam.nr-data.net",
            "applicationTime": 315,
            "applicationID": "1744824188",
            "transactionName": "ZFVbZUIHC0RWU0IMDF0fakFCDwtQdF9YERFcXFVUQkkAUF5WQkVLdHVtGA==",
            "queueTime": 0
        };
    </script>
</head>

<body>
    <div id="catalogLanDropDownParent">
        <select name="language" id="catalogLangDropDown" style="display: none"></select>
    </div>

    <div id="widget-sign-in"></div>

    <div class="boilerplate">
        <div id="main">
            <!-- 状态栏展示区域 -->
            <div class="phone-status-bar" id="custom-status-bar">
                <div class="status-left" id="status-time-display">10:13 AM</div>
                <div class="status-right" id="status-icons">
                    <i class="fa fa-signal" aria-hidden="true"></i>
                    <span>LTE</span>
                    <i class="fa fa-battery-full" aria-hidden="true"></i>
                </div>
            </div>

            <!-- 礼品卡内容 -->
            <div class="balance">
                <p id="sbux-amount"><span>$100</span> Apple Gift Card</p>
            </div>
            <div class="heading">
                <p>Apple Store, Apple Music, iPhone,</p>
                <p> iPad, AirPods, accessories, and more</p>
            </div>
            <div class="cardInfo">
                <div class="showCard imagePos">
                    <img src="https://content.blackhawknetwork.com/gcmimages/product/xlarge/W7SB3C6N5XV0QJA3WWGA0YWGQC_0608202322:59:18.PNG"
                        alt="Gift Card">
                </div>
                <div class="pin">
                    <p>PIN:
                        <span><a href="https://www.appstore.com/redeem/XQ7CN7K28CGX894P"
                                target="_blank">XQ7CN7K28CGX894P</a></span>
                    </p>
                </div>
                <div class="PinInstruction">
                    <p>To redeem, simply click on the code above.</p>
                </div>
            </div>
            <div class="cardInfo2">
                <div class="cardNum">
                    <h2>One gift card. Everything Apple.</h2>
                    <div class="desktop">
                        <img src="https://content.blackhawknetwork.com/gcmimages/View/37DQFW6Z5RZR2BADH857MX9PVC/images/itunes_desktop.png"
                            alt="logo1">
                    </div>
                    <div class="mobile">
                        <img src="https://content.blackhawknetwork.com/gcmimages/View/37DQFW6Z5RZR2BADH857MX9PVC/images/mobile_icons.jpg"
                            alt="logo2">
                    </div>
                    <div class="description">
                        <p>Use the Apple Gift Card to get products, accessories, apps,</p>
                        <p>games, music, movies, TV shows, and more. Spend it on</p>
                        <p>in-app content, books, subscriptions and even iCloud+</p>
                        <p>storage to secure files from all your Apple devices.</p>
                    </div>
                </div>
            </div>
            <div class="gcmCopy">
                <div class="instructions">
                    <div class="redeem">
                        <h3>How to use:</h3>
                        <span>Go to <a href="https://apple.com/redeem" target="_blank">apple.com/redeem</a> to add to
                            your</span>
                        <span>Apple Account. Use your balance for online and Apple Store purchases.</span>
                    </div>
                    <div class="wallet">
                        <div class="image">
                            <img src="https://content.blackhawknetwork.com/gcmimages/View/37DQFW6Z5RZR2BADH857MX9PVC/images/Wallet.png"
                                alt="wallet_img">
                        </div>
                        <span>As part of Wallet, your Apple Account balance is a quick, convenient way to pay when
                            shopping at an Apple Store or apple.com.</span>
                    </div>
                </div>
            </div>
            <div class="gcmTerms">
                <div class="headingText">
                    <h4 class="warning">Beware of gift card scams. Do not share your code.</h4>
                </div>
                <div class="terms conditions" style="display:block;">
                    <h5>Terms and Conditions</h5>
                    <p>Valid only for U.S. transactions in Apple properties. For assistance, visit <a
                            href="https://support.apple.com/en-us/" target="_blank">support.apple.com/giftcard</a> or
                        call 1-800-275-2273. Not redeemable at Apple resellers or for cash, and no resale, refunds, or
                        exchanges, except as required by law. Apple is not responsible for unauthorized use. Terms
                        apply; see <a href="https://apple.com/us/go/legal/gc"
                            target="_blank">apple.com/us/go/legal/gc</a>. Issued by Apple Value Services, LLC (AVS).</p>
                    <p>© 2025 Apple Inc. All rights reserved.</p>
                </div>
                <div class="extOrder" id="orderID"> </div>
            </div>
        </div>
    </div>

    <div id="samsungpasscontainer"></div>

    <!-- 延迟加载非核心脚本 -->
    <script defer src="https://cdn.bootcdn.net/ajax/libs/flatpickr/4.6.13/flatpickr.min.js"></script>
    <script defer src="https://cdn.bootcdn.net/ajax/libs/flatpickr/4.6.13/l10n/en.min.js"></script>
    <script defer src="scripts/googleTagManager.js"></script>
    <script async src="https://assets.adobedtm.com/5402c6525a0d/9e9dda26e937/launch-577998b63e27.min.js"></script>
    <script defer type="text/javascript" src="https://content.blackhawknetwork.com/gcmimages/View/37DQFW6Z5RZR2BADH857MX9PVC/script/template.js"></script>
    <script defer type="text/javascript" src="scripts/dataDomeScript.js"></script>
    <script defer type="text/javascript" src="scripts/global-footer.js"></script>
</body>
</html>
